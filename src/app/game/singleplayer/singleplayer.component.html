<div class="bg"></div>
<div class="fallback-color"><!-- mandatory due to blur on the foreground --></div>

<app-modal class="modal-box" [title]="'Illegal move!'" [message]="gameState.error" *ngIf="gameState.error" (closeEvent)="onHandleError()"></app-modal>
<app-game-over-modal class="modal-box" [score]="gameState.score" *ngIf="gameState.score.points"></app-game-over-modal>
<!-- <app-game-over-modal [score]="{
  points: 38,
  rank: 'Something something',
  nextRankPoints: 3,
  messageLeft: 'Better luck next time! Gather ',
  messageRight: ' more points to earn the next rank!'
}"></app-game-over-modal> -->

<div class="component-container">
  <div class="game-container">
    <!-- BUTTON PANEL -->
    <div class="button-panel">
      <div class="button-panel-left">
        <input type="checkbox" id="show-names" name="show-container-names">
        <label for="show-names">Always show container names</label>
        <button
          class="cookie-btn cookie-unawarded"
          [ngClass]="{'cookie-awarded': gameState.cookieAwarded}"
        >
            {{ gameState.cookieAwarded ? "Cookie earned!" : "Cookie not yet awarded" }}
        </button>
      </div>
      <div class="button-panel-right">
        <button class="plant-btn" [disabled]="gameState.currentAction != gameActions.NewTurn" (click)="onPot()">Plant in pot</button>
        <button class="draw-btn" [disabled]="gameState.currentAction != gameActions.NewTurn || !gameState.deck.length" (click)="onPlant()">Draw card</button>
        <button class="end-turn-btn" [disabled]="gameState.currentAction != gameActions.PotAction" (click)="onEndAction()">End turn</button>
      </div>
      <!-- TODO: question mark sign here -->
    </div>

    <!-- BOARD -->
    <div class="garden-discardpile-deck">
      <div
        class="garden community-garden"
        id="community-garden"
        [ngClass]="{
          'community-choosable': gardensChoosable.community,
          'endangered': communityGardenInDanger,
          'will-die': communityGardenAboutToDie}"
        (click)="onGardenClick($event)"
      >
        <p>COMMUNITY GARDEN</p>
        <app-card
        class="card-margin"
        *ngFor="let card of gameState.communityGarden"
        [card]="card"
        (click)="onCardClick(card)"
        ></app-card>
      </div>
      <div
        class="garden discard-pile"
        id="discard-pile"
        [ngClass]="{'discard-choosable': gardensChoosable.discard}"
        (click)="onGardenClick($event)"
      >
        <p>DISCARD PILE</p>
        <app-card [card]="gameState.discardPile[gameState.discardPile.length - 1]"></app-card>
      </div>
      <div class="garden deck">
        <p>DECK</p>
        <app-card
        [isDeck]="!anyGardenChoosable"
        [card]="gameState.deck[0]"
        [ngClass]="{'must-draw': gameState.currentAction == gameActions.PlantAction && !anyGardenChoosable}"
        (click)="onDeckClick()"
        ></app-card>
      </div>
    </div>
    <div class="garden pots">
      <app-pot
      class=""
      *ngFor="let pot of gameState.pots; let i = index"
      [pot]="pot"
      [i]="i"
      (click)="onCardClick(pot)"
      ></app-pot>
    </div>
    <div
      class="garden private-garden"
      id="private-garden"
      [ngClass]="{'private-choosable': gardensChoosable.private}"
      (click)="onGardenClick($event)"
    >
      <p>PRIVATE GARDEN</p>
      <app-card
      class="card-margin"
      *ngFor="let card of gameState.privateGarden"
      [card]="card"
      (click)="onCardClick(card)"
      ></app-card>
    </div>
    <!-- <span>Photo by <a href="https://unsplash.com/@scottwebb?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Scott Webb</a> on <a href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></span> -->
  </div>
</div>
